<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Problematic handling of array configuration items in ASP.Net core | CKolumbus' Blog</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="https://ckolumbus.github.io/blog/2018/02/problematic-handling-of-array-configuration-items-in-aspnet-core/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Chris Drexler">
<link rel="prev" href="../../../2014/04/backporting-qt-app-from-python3-to-python2-sip-api-versions/" title="Backporting Qt App from Python3 to Python2 (SIP API Versions)" type="text/html">
<meta property="og:site_name" content="&lt;img src=&quot;/images/ckolumbus.jpg&quot;&gt; CKolumbus' Blog">
<meta property="og:title" content="Problematic handling of array configuration items in ASP.Net core">
<meta property="og:url" content="https://ckolumbus.github.io/blog/2018/02/problematic-handling-of-array-configuration-items-in-aspnet-core/">
<meta property="og:description" content="This post refers to the handling of array configuration items as they 
exist in ASP.Net core Configuration 
since 1.0 up to now (RT 2.0.5, SDK 2.1.4).
Example on how ASP.Net Core handles overwriting l">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-02-11T17:07:28+01:00">
<meta property="article:tag" content="aspnetcore">
<meta property="article:tag" content="configuration">
<meta property="article:tag" content="dotnetcore">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<div class="blog-masthead">
    <div class="container">
<!-- This keeps the margins nice -->
        <nav class="blog-nav" role="navigation"><a href="../../../../" class="blog-nav-item">Home</a>
            <a href="../../../" class="blog-nav-item">Blog</a>
            <a href="../../../../archive.html" class="blog-nav-item">Archive</a>
            <a href="../../../../categories/" class="blog-nav-item">Tags</a>
            <a href="../../../../rss.xml" class="blog-nav-item">RSS feed</a>
            <a href="https://github.com/ckolumbus" class="blog-nav-item"><img src="../../../../images/blacktocat.png" alt="Follow me on GitHub"></a>

            
                
<!-- DuckDuckGo custom search -->
<form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://ckolumbus.github.io/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Searchâ€¦" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


                
                
                    
    <a href="index.md" class="blog-nav-item blog-nav-item-aside" id="sourcelink">Source</a>

                
            
        </nav>
</div>
<!-- /.container -->
</div>
<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <div class="blog-header">
            <h1 class="blog-title">
                <a href="https://ckolumbus.github.io/">

                    <span id="blog-title"><img src="../../../../images/ckolumbus.jpg"> CKolumbus' Blog</span>
                </a>
            </h1>
            <p class="lead blog-description">development rumblings: linux, python, go, C#, .Net Core, arduino and more</p>
            
        </div>
        <!--Body content-->
        <div class="row">
            <div class="col-sm-8 blog-main">
                
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h2 class="p-name entry-title blog-post-title" itemprop="headline name"><a href="." class="u-url">Problematic handling of array configuration items in ASP.Net core</a></h2>

        <div class="metadata blog-post-meta">
            <p class="byline author vcard"><span class="byline-name fn">Chris Drexler</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-02-11T17:07:28+01:00" itemprop="datePublished" title="2018-02-11 17:07">2018-02-11 17:07</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/2018/02/problematic-handling-of-array-configuration-items-in-aspnet-core.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This post refers to the handling of array configuration items as they 
exist in <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/">ASP.Net core Configuration</a> 
since 1.0 up to now (RT 2.0.5, SDK 2.1.4).</p>
<p>Example on how ASP.Net Core handles overwriting loaded array configuration
when the later read config files contain less array entries than before.</p>
<p>Arrays are not complete replaced but only the first <code>n</code> entries that are
actully given in the later config files are being replaced, leaving</p>
<p>There is an <a href="https://github.com/ckolumbus/Example_Issue_AspnetConfigurationArrayOverwrite">repository</a> 
with a complete working example demonstrating the following behavior.</p>
<h3>Exampmle configuration files</h3>
<p><code>appsettings.json</code></p>
<pre class="code literal-block"><span></span>{
  "wizards": [
    {
      "Name": "Gandalf",
      "Age": "1000"
    },
    {
      "Name": "Harry",
      "Age": "17"
    }
  ]
}
</pre>


<p><code>appsettings2.json</code></p>
<pre class="code literal-block"><span></span>{
  "wizards": [
    {
      "Name": "Houdini",
      "Age": "300"
    }
  ]
}
</pre>


<h3>Setup</h3>
<ul>
<li>read appsettings.json with two entries in 'wizard'  array</li>
<li>read additaonal appsettings2.json with only one array entry in 'wizards'</li>
</ul>
<h3>Code</h3>
<pre class="code literal-block"><span></span>var builder = new ConfigurationBuilder()
    .SetBasePath(Directory.GetCurrentDirectory())
    .AddJsonFile("appsettings.json")
    .AddJsonFile("appsettings2.json");
</pre>


<h3>(My) Expected output</h3>
<p>the array is replaced by the latest definition resulting in only one entry in the array</p>
<pre class="code literal-block"><span></span>    [wizards, ]
    [wizards:0, ]
    [wizards:0:Name, Houdini]
    [wizards:0:Age, 300]
</pre>


<h3>Real Output</h3>
<p>only the first entry of the existing array is overwritten, the second one remains</p>
<pre class="code literal-block"><span></span>    [wizards, ]
    [wizards:1, ]
    [wizards:1:Name, Harry]
    [wizards:1:Age, 17]
    [wizards:0, ]
    [wizards:0:Name, Houdini]
    [wizards:0:Age, 300]
</pre>


<h3>Issue</h3>
<p>when having multiple sources of configuration items it's somehwat
unexpected behavior that the ultimate entries of an array depends
on how many entries have been given in the setting sources before.</p>
<p>Expected behavor IMHO would be that the complete array would be
replaced with the last set of entries. </p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/aspnetcore/" rel="tag">aspnetcore</a></li>
            <li><a class="tag p-category" href="../../../../categories/configuration/" rel="tag">configuration</a></li>
            <li><a class="tag p-category" href="../../../../categories/dotnetcore/" rel="tag">dotnetcore</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../../2014/04/backporting-qt-app-from-python3-to-python2-sip-api-versions/" rel="prev" title="Backporting Qt App from Python3 to Python2 (SIP API Versions)">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="ckolumbusgithub",
            disqus_url="https://ckolumbus.github.io/blog/2018/02/problematic-handling-of-array-configuration-items-in-aspnet-core/",
        disqus_title="Problematic handling of array configuration items in ASP.Net core",
        disqus_identifier="cache/posts/2018/02/problematic-handling-of-array-configuration-items-in-aspnet-core.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="ckolumbusgithub";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
            <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
                <div class="sidebar-module sidebar-module-inset">
  <h4>About</h4>
  <p>This is my little development blog with some additional
      pages of information </p>
</div>
<div class="sidebar-module">
  <h4>Pages</h4>
  <ol class="list-unstyled">
<li><a href="../../../../pages/languages/go">GOLang</a></li>
    <li><a href="../../../../pages/languages/python">Python</a></li>
    <li><a href="../../../../pages/languages/dotnet">.Net Core/C#</a></li>
  </ol>
<h4>Social</h4>
  <ol class="list-unstyled">
<li><a href="https://twitter.com/CKolumbus_">@CKolumbus_</a></li>
  </ol>
</div>

            </div>
        <!--End of body content-->
        </div>
    </div>
</div>

<footer class="blog-footer" id="footer">
    Contents Â© 2018         <a href="mailto:ckolumbus@ac-drexler.de">Chris Drexler</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
    
</footer><script src="../../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
